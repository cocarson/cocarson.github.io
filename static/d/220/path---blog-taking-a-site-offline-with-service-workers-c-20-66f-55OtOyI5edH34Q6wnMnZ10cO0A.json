{"data":{"markdownRemark":{"html":"<p>Service workers are a technology that have been emphasized by the web community for the past few years, along with terms like \"Progressive Web Apps\" and other futuristic technologies. To be honest, I was always put off by the name. It so jargon-y and technical that I figured it must be a fad that was better to let pass.</p>\n<p>Of course, this does not appear to be the case. Service workers are being implemented all over the web - from sites trying to provide seamless offline experiences to mega blogs interested in bombarding you with desktop push notifications, service workers have become an important part of the web.</p>\n<p>So what is a service worker? In its simplest form, a service worker is a JavaScript file that has access to a page's requests and responses. For some reason I figured a service worker had to be a lot more complex than that. But not really, service workers are just scripts that intercepts network requests.</p>\n<p>What is the value in a script that intercepts page requests? One of the core motivations for service workers is for providing better experiences when internet connection is lost. This is especially relevant for mobile devices where cellular connection could be lost at any time (or my home wifi network). In mobile apps, if you loose connection apps doesn't crash and burn, instead they often let you know about the connection loss and allows you to continue using the app with what ever data it has downloaded. When connection returns, the app doesn't require a full reboot (refresh), instead it automatically reconnects and immediately performs relevant network requests.</p>\n<p>The allure of service workers is their potential to allow web apps to exhibit similar functionality. This is especially necessary internationally where phone plans may be limited and users do not want to download entire apps to their restricted phone storage. Instead they can use the web app, without missing out on the benefits of a mobile application.</p>\n<h2>Getting Started</h2>\n<p>To start writing a service worker there are a few JavaScript prerequisites I recommend understanding:</p>\n<ol>\n<li>Event based programming</li>\n<li>Promises</li>\n</ol>\n<p>[1.] Service workers respond to events - the FetchEvent, InstallEvent, NotificationEvent, and SyncEvent to name a few. I would definitely recommend understanding JS event based programming and callbacks before learning to write a service worker.</p>\n<p>[2.] Writing Promises. While Promise logic is not always easy to follow, understanding the way they work is required for writing a service worker. Service work APIs rely heavily on Promises because they are intercepting every single request a site makes, so it is important the code is non-blocking.</p>\n<p>All that is left to begin writing a service worker is learning the related APIs and how they fit together. This requires a bit of memorization off the bat, but luckily there is great <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API\">documentation</a> for reference. (love you MDN)</p>\n<p>The service worker that we are going to write is relatively minimal. It should cache all of the requests related to a web page. This includes the HTML page and all of the assets loaded by that page.</p>\n<h3>Service Worker Lifecycle</h3>\n<p>Service worker files are loaded by the browser differently than normal HTML, CSS and JS files. Instead of being fetched and parsed on page load, service workers go through an install process, or \"lifecycle\". The service worker only works through its lifecycle when it is registered and when it is unregistered; otherwise the service worker is cached by the browser.</p>\n<p>The service workers lifecycle looks like this:</p>\n<ol>\n<li>download</li>\n<li>install</li>\n<li>activate</li>\n</ol>\n<p>The <code class=\"language-text\">install</code> and <code class=\"language-text\">activate</code> events will both be fired when a new service worker is registered for use. The difference between the two is that the <code class=\"language-text\">install</code> event can execute while another service worker is still in use.</p>\n<p>There can only be one activated version of a service worker at a time. A service worker that is ready to be replaced will remain activated as long as one page is using the service worker.</p>\n<p>So how should we use each? The <code class=\"language-text\">install</code> event is useful for setting up any initial data the service worker will need. An example usage of the <code class=\"language-text\">install</code> event could be to fetch and cache an <code class=\"language-text\">offline.html</code> file so that it is ready if the connection is lost. Because the <code class=\"language-text\">activate</code> event will only run when no other service workers are activated, we can safely use this method to clean up any cached data left over by a previous service worker.</p>\n<p>Responding to each looks a little something like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// sw.js</span>\n\nself<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'install'</span><span class=\"token punctuation\">,</span> event <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// handle event</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\nself<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'activate'</span><span class=\"token punctuation\">,</span> event <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// handle event</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3>Handling Requests</h3>\n<p>After a service worker has been installed and activated it can begin processing web requests. In order to do so we want to listen to the <code class=\"language-text\">fetch</code> event. Handling requests is where the meat of our service worker will live.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// sw.js</span>\n\nself<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fetch'</span><span class=\"token punctuation\">,</span> event <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// handle event</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>An empty event handler isn't too fun, so let's add something to it! Let's log all of the requests for a given web page.</p>\n<p><a href=\"https://glitch.com/~level-teller\">Demo</a></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// sw.js</span>\n\nself<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fetch'</span><span class=\"token punctuation\">,</span> event <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// log request url</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'logging!'</span><span class=\"token punctuation\">,</span> event<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Service workers also have the ability to respond to the requests.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// sw.js</span>\n\nself<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fetch'</span><span class=\"token punctuation\">,</span> event <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  event<span class=\"token punctuation\">.</span><span class=\"token function\">respondWith</span><span class=\"token punctuation\">(</span><span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>In this case, we use the <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/FetchEvent/respondWith\"><code class=\"language-text\">event.respondWith()</code></a> method which accepts a Promise to dictate how the service worker should respond to the request. The above example will simply use the <code class=\"language-text\">fetch</code> API to make the same request that the browser would have made if the service worker were not present.</p>\n<p>Great! Now that we're responding to requests, we can start to have a little more fun.</p>\n<h3>Caching Requests</h3>\n<p>The final exercise to review before we begin building a service worker is caching. If a webpage has some data or imagery that is needed by many pages it may be a good idea to cache these items so they are not downloaded in the future. Caching all requests will allow a site to be loaded offline.</p>\n<p>Service workers rely on the <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/CacheStorage\"><code class=\"language-text\">CacheStorage</code></a> API for caching requests. The Chrome developer tools event have a special area for view the items in <code class=\"language-text\">CacheStore</code>.</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/274b08e79a737e994d7a68ba925f7dea/14554/cache-storage.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 660px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 70.70610687022901%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB/ElEQVQ4y52SXU/aUBjHiwSJkZeQLGQuOw0tUHlJRiml9O20tZsuKoVI9dors33R7UPoxXa5abOY3Y767DmFJYWJcWvyy3N6zr//nueFm2WV3OXUPnZPrHNqezObOqHr+eHJ6TjhdDxBgnAcTMIgmIbBZBoeHr0PDdMKE617MKOOe2FT97jRkHLcXqW6Ry393qImGIYJum6Apo0w6gmLPR1M00rOGNL+PtRqNej1ejAajWCgqiDL8o9qtfqay+W3eUqdO887gOFwOMeDWBTFFEIsCsLKuyAsWO7N6/U64Pv3UqkkcFuZLWLb9p3v++A4Ttzv9x9Q9ICiZ8FMl4a3aFjjyuUywZQidnVVVWO8ITABCpO4idT5quF2Pk9c1418/y24nhcrirJi9mfNYprU3qphJpMhDqXR0eE7MA0jlrHQ6zdk60ajAc1mM2HtR6uGhWKJ6KYd6ZYDsqrFb2TlUUNJkqDVakG73U5MNxpyOy+IenYVDcKPIJ99iCX/YiFOpZVOGT98OuWd3V1iWHaEQwq6acX9gfpXQx5r0MYbFosFgh2+1bQh9GV5jjVkgrVZfJJfS8NviWGlUuFx9n5qmsYGG1iXWQP+hWVN73EEBQ5dX3Y6nc/dbvcLco2Fv+F5/oYQ8lyuUf8V46dCofCKwyeLsIWICP+JuPTI/gaHSFZMgq4DAwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"Cache Storage\"\n        title=\"\"\n        src=\"/static/274b08e79a737e994d7a68ba925f7dea/021ca/cache-storage.jpg\"\n        srcset=\"/static/274b08e79a737e994d7a68ba925f7dea/1ac00/cache-storage.jpg 165w,\n/static/274b08e79a737e994d7a68ba925f7dea/ab733/cache-storage.jpg 330w,\n/static/274b08e79a737e994d7a68ba925f7dea/021ca/cache-storage.jpg 660w,\n/static/274b08e79a737e994d7a68ba925f7dea/86605/cache-storage.jpg 990w,\n/static/274b08e79a737e994d7a68ba925f7dea/6ab68/cache-storage.jpg 1320w,\n/static/274b08e79a737e994d7a68ba925f7dea/0a3a7/cache-storage.jpg 1980w,\n/static/274b08e79a737e994d7a68ba925f7dea/14554/cache-storage.jpg 2096w\"\n        sizes=\"(max-width: 660px) 100vw, 660px\"\n      />\n  </span>\n  </a></p>\n<p><a href=\"https://glitch.com/~nickel-fold\">Demo</a></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// sw.js</span>\n\nself<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fetch'</span><span class=\"token punctuation\">,</span> event <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  caches<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'my-cache'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>cache <span class=\"token operator\">=></span> cache<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><img src=\"updated-cache.jpg\" alt=\"Updated cache\"></p>\n<p>Now we are storing the requests in the cache!</p>\n<p>So we're adding data to the cache, but never using it. In order to do we'll have to call the <code class=\"language-text\">event.respondWith()</code> from the previous section. For now, lets update our service work to do the following things:</p>\n<ol>\n<li>If a request exists in the cache, respond with the cached response</li>\n<li>If the request is not in the cache, fetch and cache the response</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// sw.js</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">findInCache</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> caches<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'my-cache'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>cache <span class=\"token operator\">=></span> cache<span class=\"token punctuation\">.</span><span class=\"token function\">match</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">addToCache</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>response <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>response<span class=\"token punctuation\">.</span>ok<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TypeError</span><span class=\"token punctuation\">(</span><span class=\"token string\">'bad response status'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    caches<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'my-cache'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>cache <span class=\"token operator\">=></span> cache<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">,</span> response<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> response\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\nself<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fetch'</span><span class=\"token punctuation\">,</span> event <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  event<span class=\"token punctuation\">.</span><span class=\"token function\">respondWith</span><span class=\"token punctuation\">(</span>\n    <span class=\"token function\">findInCache</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span>error <span class=\"token operator\">=></span> <span class=\"token function\">addToCache</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span>error <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3>Installing a service worker</h3>\n<p>A service worker needs to be \"installed\" before it can begin processing requests. We'll dive into the service worker \"life cycle\" a little later, but for now just know that simply having a service worker file in the working directory is not enough to begin processing requests.</p>\n<p>I created a simple website <a href=\"https://glitch.com/edit/#!/level-teller\">Glitch project</a> that you can \"remix\" (top right corner) and use to follow along. Besides being an awesome platform for sharing and experimenting with code, Glitch will also host your project online. This is important because we're attempting to load a site offline, if the browser is loading the files locally, then we can't test the offline behavior! If you know how to set up</p>\n<p>Site structure:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// Home page</span>\n<span class=\"token operator\">/</span>index<span class=\"token punctuation\">.</span>html\n\n<span class=\"token comment\">// Extra page for testing</span>\n<span class=\"token operator\">/</span>page2<span class=\"token punctuation\">.</span>html\n\n<span class=\"token comment\">// Display when connection is lost</span>\n<span class=\"token operator\">/</span>offline<span class=\"token punctuation\">.</span>html\n\n<span class=\"token comment\">// Our stylesheet</span>\n<span class=\"token operator\">/</span>style<span class=\"token punctuation\">.</span>css\n\n<span class=\"token comment\">// Do the JavaScripts</span>\n<span class=\"token operator\">/</span>script<span class=\"token punctuation\">.</span>js\n\n<span class=\"token comment\">// The ✨service worker ✨</span>\n<span class=\"token operator\">/</span>sw<span class=\"token punctuation\">.</span>js</code></pre></div>\n<p>Okay, so let's get started! The service workers (<code class=\"language-text\">sw.js</code>) has some super basic code inside of it. The initial contents are:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// sw.js - this is the service worker!</span>\nself<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'install'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>installEvent<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Service worker installed! 🎉'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>So we're looking for the message 'Service worker installed! 🎉' to be logged to the console, but it isn't. Remember how I said the service worker had to be installed before it can begin processing requests? Well, we never installed it! To do so, we're going to update <code class=\"language-text\">script.js</code> to register our service worker.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// script.js</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'script.js loaded'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// first check if the serviceWorkers API is supported!</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'serviceWorker'</span> <span class=\"token keyword\">in</span> navigator<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  navigator<span class=\"token punctuation\">.</span>serviceWorker<span class=\"token punctuation\">.</span><span class=\"token function\">register</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./sw.js'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> scope<span class=\"token punctuation\">:</span> <span class=\"token string\">'/'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>The above code will first check if the browser supports the service worker API and then call the <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerContainer/register\">register()</a> method on <code class=\"language-text\">navigator.serviceWorker</code> which is a <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerContainer\">ServiceWorkerContainer</a> object. I'm a big believer in becoming comfortable with the documentation of whatever I'm learning, so I'll try to link to everything as I go.</p>\n<p>The <code class=\"language-text\">ServiceWorkerContainer.register()</code> method accepts two paramaters:</p>\n<ol>\n<li>The path to the service worker script (<code class=\"language-text\">sw.js</code> in our case)</li>\n<li>An object defining the scope which the service worker should be used on (<code class=\"language-text\">&#39;/&#39;</code> scopes all from our domain)</li>\n</ol>\n<p>Now when the site loads it will register our service worker if it hasn't already been registered. To verify the service worker has been installed, we can navigate to the 'Application' tab of the Chrome Developer Tools and the 'Service Workers' menu side bar item.</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c3fc1bc63b65b58b6a2d062aeea775cd/a231f/sw-debug.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 660px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 77.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAACnUlEQVQ4y6WTyW4TQRCGLRA8BCFeZvOs9tgx8RIvkUIcQZQYL8Q2J94iTwE3bty4AwcOgBCRolgotiN4CDRIuXEkE3fxV49jGcQlYqRP1dOq/qqqPY6N37/a/jT+2P42/bo/nYxbk8mkNR6PW9PptHVyctI6OjqSfAYT7H85Pm6NeH162jo7O+P8feR2R6ORGeOn1310fvBkQP3BkA76fcQBDYZDGiB2ez3qdDrUQ2wjDjg26rRXKVN/f48eI7/dblMfcXd397kU7lSrP3ZqNarm85f3XEek02nhuJ5wXVekVVUkFUWkAMd4MiXiq6sLViV3LxLxOK2s3ImE3e37572HD6iz05xtl0rCMk3hep7wQcG2RckyxYZjiw3bEmWsNV0XOqNpQjdMoaedMG1nSFG0SFgsloL19XVaW1ubZTIZQoeE7sjD2nEc8ow0GapKJqOppCJqmhZFwyLN9ELD9il1Jdzc3Ay2trYIcZbP52WioijyEBfI+jlyvQx52SzZKKRqOmlLUlVVQkPXKJlMRsJGoxE0m02qVCqzLA5xImOa6DTrQehTBvsepKaTJVW3WAKxFqFqIa4AwlQkLJfLAWSE7v4Q8ui27WB8T8psxyXDyhAfvsph8B6alkWp1FxYrVaDer1OtVptMTIjhXyHGDvq0EMBmwzsLwuRF+ZwbiFEdwGkVCqVpHCpMhmGgdFN4g44Xu0vg5yQC+HeIyFEQbFYpFwuN/P9bNQVRuRR8fnIKMdE13+POyfkwosOIQoKhYL8bLCWo8quluA9hg/+g9Cy+IdSF8LvkLHwwvf9SyRcl19cFMJnUoh7+8kjzz9u4mrXgWX8B8DoL6QQLy/BO/AGCW9xF9flNfiQSCSexubPTXD7P7kFbhweHsZ+A1/jukpCiXWhAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"View of service worker\"\n        title=\"\"\n        src=\"/static/c3fc1bc63b65b58b6a2d062aeea775cd/1dc1d/sw-debug.png\"\n        srcset=\"/static/c3fc1bc63b65b58b6a2d062aeea775cd/7d8cb/sw-debug.png 165w,\n/static/c3fc1bc63b65b58b6a2d062aeea775cd/a2a24/sw-debug.png 330w,\n/static/c3fc1bc63b65b58b6a2d062aeea775cd/1dc1d/sw-debug.png 660w,\n/static/c3fc1bc63b65b58b6a2d062aeea775cd/3a2d0/sw-debug.png 990w,\n/static/c3fc1bc63b65b58b6a2d062aeea775cd/4dfd0/sw-debug.png 1320w,\n/static/c3fc1bc63b65b58b6a2d062aeea775cd/91d3b/sw-debug.png 1980w,\n/static/c3fc1bc63b65b58b6a2d062aeea775cd/a231f/sw-debug.png 2160w\"\n        sizes=\"(max-width: 660px) 100vw, 660px\"\n      />\n  </span>\n  </a></p>\n<p>Highlighted in red are the two menus selections I made to view the state of the service worker on our site. Notice the \"Update on reload\" checkbox is also checked. This will tell the browser to fetch the service worker file on reload. Because service workers are inherently cached by the browser (in order to process offline requests), the browser will not request new versions of the service worker unless explicitly told to do so.</p>\n<p>My flow is to check the \"Update on reload\" checkbox when ever I make changes to <code class=\"language-text\">sw.js</code> and then un-check the box and refresh one more time. The extra refresh allows the updated service worker to process requests after being installed.</p>","frontmatter":{"date":"March 05, 2019","path":"/blog/taking-a-site-offline-with-service-workers","title":"Taking a Site Offline with Service Workers 🤖","image":null}}},"pageContext":{}}